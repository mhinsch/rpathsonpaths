<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Overview of the rpathsonpaths package • rpathsonpaths</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">rpathsonpaths</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/overview.html">Overview of the rpathsonpaths package</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/mhinsch/rpathsonpaths">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Overview of the rpathsonpaths package</h1>
                        <h4 class="author">Martin Hinsch</h4>
            
            <h4 class="date">2017-11-17</h4>
          </div>

    
    
<div class="contents">
<p><em>rpathsonpaths</em> provides functions to simulate the spread of biological organisms on a substrate that is itself moving through a network structure (e.g. pathogens in a food distribution network or infections in migrating animals). This vignette provides an overview of current features. It largely reproduces the content of <code>REAME.md</code>.</p>
<p><br></p>
<div id="installing-the-package" class="section level1">
<h1 class="hasAnchor">
<a href="#installing-the-package" class="anchor"></a>Installing the package</h1>
<p><em>rpathsonpaths</em> is currently only available on github.</p>
<p>Prerequisites:</p>
<ul>
<li><p>C++ boost libraries</p></li>
<li><p><em>Rcpp</em> (&gt;= 0.12.9)</p></li>
</ul>
<p>Some of the functionality will also require the <em>igraph</em> package.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">devtools::<span class="kw">install_github</span>(<span class="st">"reconhub/incidence"</span>)</code></pre></div>
<p>Note that this requires the package <em>devtools</em> to be installed.</p>
<p><br></p>
</div>
<div id="what-does-it-do" class="section level1">
<h1 class="hasAnchor">
<a href="#what-does-it-do" class="anchor"></a>What does it do?</h1>
<p><em>rpathsonpaths</em> provides functions to simulate the spread of a population in a substrate that itself is transported across a directed graph. The paradigmatic example is the spread of pathogens in food transport networks, but other instances might include for examples infections in migrating animals.</p>
<p>The most important functions include:</p>
<ul>
<li><p><strong><code>popsnetwork</code></strong>: create a network object from an edgelist (describing the transport graph) and a list of external sources.</p></li>
<li><p><strong><code>set_allele_freq</code></strong>: set the population composition in source nodes.</p></li>
<li><p><strong><code>popgen_dirichlet</code></strong>: simulate spread of genetic material on the network using a Dirichlet distribution to approximate genetic drift.</p></li>
<li><p><strong><code>draw_isolates</code></strong>: draw a number of random individuals from a set of nodes using the simulated allele frequencies.</p></li>
<li><p><strong><code>plot</code></strong>: plot a <em>popsnetwork</em> object (currently uses <em>igraph</em>, but more backends are planned).</p></li>
</ul>
<p><br></p>
</div>
<div id="a-quick-overview" class="section level1">
<h1 class="hasAnchor">
<a href="#a-quick-overview" class="anchor"></a>A quick overview</h1>
<p>The following worked example provides a brief overview of the package’s functionalities.</p>
<div id="preparing-the-network" class="section level2">
<h2 class="hasAnchor">
<a href="#preparing-the-network" class="anchor"></a>Preparing the network</h2>
<p>First, we prepare an edge list describing the network, and the initial state of the source nodes:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(rpathsonpaths)

inp &lt;-<span class="st"> </span><span class="kw">c</span>(0L, 0L, 1L, 2L, 3L, 1L, 5L)
outp &lt;-<span class="st"> </span><span class="kw">c</span>(1L, 2L, 3L, 3L, 4L, 4L, 2L)
rates &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="fl">1.5</span>, <span class="fl">0.5</span>, <span class="fl">0.1</span>, <span class="dv">1</span>, <span class="fl">0.1</span>, <span class="fl">0.5</span>)
edgelist &lt;-<span class="st"> </span><span class="kw">data.frame</span>(inp, outp, rates)
ext &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">c</span>(0L, 5L), <span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>))</code></pre></div>
<p>Now we can create a <em>popsnetwork</em> object:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
netraw &lt;-<span class="st"> </span><span class="kw"><a href="../reference/popsnetwork.html">popsnetwork</a></span>(edgelist, ext, <span class="fl">0.1</span>)
netraw
<span class="co">#&gt; Nodes:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; id   infected    input   alleles...</span>
<span class="co">#&gt; 0    0.55    1</span>
<span class="co">#&gt; 1    0.595   1</span>
<span class="co">#&gt; 2    0.595   2</span>
<span class="co">#&gt; 3    0.6355  0.6</span>
<span class="co">#&gt; 4    0.668636    1.1</span>
<span class="co">#&gt; 5    0.55    1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Links:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; from to  rate    infected</span>
<span class="co">#&gt; 0    1   1   0.55</span>
<span class="co">#&gt; 0    2   1.5 0.55</span>
<span class="co">#&gt; 1    3   0.5 0.595</span>
<span class="co">#&gt; 2    3   0.1 0.595</span>
<span class="co">#&gt; 3    4   1   0.6355</span>
<span class="co">#&gt; 1    4   0.1 0.595</span>
<span class="co">#&gt; 5    2   0.5 0.55</span>
<span class="kw">plot</span>(netraw)
<span class="co">#&gt; Loading required namespace: igraph</span></code></pre></div>
<p><img src="figs-overview/popsnetwork-1.png" width="672"></p>
</div>
<div id="injecting-initial-populations-and-simulating-spread" class="section level2">
<h2 class="hasAnchor">
<a href="#injecting-initial-populations-and-simulating-spread" class="anchor"></a>Injecting initial populations and simulating spread</h2>
<p>We set up the initial populations of the source nodes:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">freqs &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="fl">0.1</span>, <span class="fl">0.4</span>, <span class="fl">0.3</span>, <span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="fl">0.4</span>, <span class="fl">0.3</span>), <span class="dt">ncol=</span><span class="dv">4</span>, <span class="dt">nrow=</span><span class="dv">2</span>)
netini &lt;-<span class="st"> </span><span class="kw"><a href="../reference/set_allele_freqs.html">set_allele_freqs</a></span>(netraw, <span class="kw">list</span>(<span class="kw">c</span>(0L, 5L), freqs))
netini
<span class="co">#&gt; Nodes:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; id   infected    input   alleles...</span>
<span class="co">#&gt; 0    0.55    1   0.1 0.3 0.2 0.4</span>
<span class="co">#&gt; 1    0.595   1   0   0   0   0</span>
<span class="co">#&gt; 2    0.595   2   0   0   0   0</span>
<span class="co">#&gt; 3    0.6355  0.6 0   0   0   0</span>
<span class="co">#&gt; 4    0.668636    1.1 0   0   0   0</span>
<span class="co">#&gt; 5    0.55    1   0.4 0.1 0.2 0.3</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Links:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; from to  rate    infected</span>
<span class="co">#&gt; 0    1   1   0.55</span>
<span class="co">#&gt; 0    2   1.5 0.55</span>
<span class="co">#&gt; 1    3   0.5 0.595</span>
<span class="co">#&gt; 2    3   0.1 0.595</span>
<span class="co">#&gt; 3    4   1   0.6355</span>
<span class="co">#&gt; 1    4   0.1 0.595</span>
<span class="co">#&gt; 5    2   0.5 0.55</span></code></pre></div>
<p>Now we are ready to simulate spread of genetic material in the network. Note that every call to popgen_dirichlet will generally produce a different allele frequency distribution.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">netdir1 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/popgen_dirichlet.html">popgen_dirichlet</a></span>(netini, <span class="fl">1.7</span>)
netdir1
<span class="co">#&gt; Nodes:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; id   infected    input   alleles...</span>
<span class="co">#&gt; 0    0.55    1   0.1 0.3 0.2 0.4</span>
<span class="co">#&gt; 1    0.595   1   0.0164354   0.618853    0.169703    0.195009</span>
<span class="co">#&gt; 2    0.595   2   0.0315208   0.681183    0.186286    0.101011</span>
<span class="co">#&gt; 3    0.6355  0.6 9.40395e-18 0.825727    0.0741663   0.100107</span>
<span class="co">#&gt; 4    0.668636    1.1 3.15029e-16 0.920167    1.24834e-05 0.079821</span>
<span class="co">#&gt; 5    0.55    1   0.4 0.1 0.2 0.3</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Links:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; from to  rate    infected</span>
<span class="co">#&gt; 0    1   1   0.55</span>
<span class="co">#&gt; 0    2   1.5 0.55</span>
<span class="co">#&gt; 1    3   0.5 0.595</span>
<span class="co">#&gt; 2    3   0.1 0.595</span>
<span class="co">#&gt; 3    4   1   0.6355</span>
<span class="co">#&gt; 1    4   0.1 0.595</span>
<span class="co">#&gt; 5    2   0.5 0.55</span>
netdir2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/popgen_dirichlet.html">popgen_dirichlet</a></span>(netini, <span class="fl">1.7</span>)
netdir2
<span class="co">#&gt; Nodes:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; id   infected    input   alleles...</span>
<span class="co">#&gt; 0    0.55    1   0.1 0.3 0.2 0.4</span>
<span class="co">#&gt; 1    0.595   1   4.8463e-07  0.926522    0.0503442   0.0231335</span>
<span class="co">#&gt; 2    0.595   2   0.207686    0.294043    0.0703513   0.42792</span>
<span class="co">#&gt; 3    0.6355  0.6 0.0517904   0.789506    0.0456129   0.113091</span>
<span class="co">#&gt; 4    0.668636    1.1 0.000386095 0.999375    7.759e-14   0.000239371</span>
<span class="co">#&gt; 5    0.55    1   0.4 0.1 0.2 0.3</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Links:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; from to  rate    infected</span>
<span class="co">#&gt; 0    1   1   0.55</span>
<span class="co">#&gt; 0    2   1.5 0.55</span>
<span class="co">#&gt; 1    3   0.5 0.595</span>
<span class="co">#&gt; 2    3   0.1 0.595</span>
<span class="co">#&gt; 3    4   1   0.6355</span>
<span class="co">#&gt; 1    4   0.1 0.595</span>
<span class="co">#&gt; 5    2   0.5 0.55</span></code></pre></div>
</div>
<div id="drawing-samples" class="section level2">
<h2 class="hasAnchor">
<a href="#drawing-samples" class="anchor"></a>Drawing samples</h2>
<p>Finally we can draw samples from our simulated population.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">samplconf &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">c</span>(2L, 4L), <span class="kw">c</span>(10L, 10L))
<span class="kw"><a href="../reference/draw_isolates.html">draw_isolates</a></span>(netdir1, samplconf)
<span class="co">#&gt;   node allele_0 allele_1 allele_2 allele_3</span>
<span class="co">#&gt; 1    2        0        8        1        1</span>
<span class="co">#&gt; 2    4        0       10        0        0</span>
<span class="kw"><a href="../reference/draw_isolates.html">draw_isolates</a></span>(netdir2, samplconf)
<span class="co">#&gt;   node allele_0 allele_1 allele_2 allele_3</span>
<span class="co">#&gt; 1    2        2        4        3        1</span>
<span class="co">#&gt; 2    4        0       10        0        0</span></code></pre></div>
</div>
</div>
<div id="an-example-using-real-data" class="section level1">
<h1 class="hasAnchor">
<a href="#an-example-using-real-data" class="anchor"></a>An example using real data</h1>
<p>Let’s load the data:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(outbreaks)
<span class="kw">data</span>(s_enteritidis_pt59)
raw_graph =<span class="st"> </span>s_enteritidis_pt59$graph
sent_graph =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">from=</span>raw_graph[[<span class="dv">1</span>]], <span class="dt">to=</span>raw_graph[[<span class="dv">2</span>]])</code></pre></div>
<p>Just in case we do some sanity checks.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(rpathsonpaths)
<span class="kw"><a href="../reference/colour_network.html">colour_network</a></span>(sent_graph)
<span class="co">#&gt;   [1] 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3</span>
<span class="co">#&gt;  [36] 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3</span>
<span class="co">#&gt;  [71] 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3</span>
<span class="kw"><a href="../reference/cycles.html">cycles</a></span>(sent_graph)
<span class="co">#&gt; [1] TRUE</span></code></pre></div>
<p>Ok, we do have one contiguous network. Unfortunately, however, there’s a cycle. This will make rpathsonpaths very unhappy so we have to get rid of it.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/cycles.html">cycles</a></span>(sent_graph, <span class="ot">TRUE</span>)
<span class="co">#&gt; [[1]]</span>
<span class="co">#&gt; [1] 0b6e5a 13dc78</span>
<span class="co">#&gt; 98 Levels: 2e7967 cd48bf dd73b6 7ba446 642cb4 c7cd02 5b44d7 ... 486c07</span>
sent_graph2 &lt;-<span class="st"> </span><span class="kw">subset</span>(sent_graph, !(from==<span class="st">"13dc78"</span> &amp;<span class="st"> </span>to==<span class="st">"0b6e5a"</span>))
<span class="kw"><a href="../reference/cycles.html">cycles</a></span>(sent_graph2)
<span class="co">#&gt; [1] FALSE</span></code></pre></div>
<p>Ok, this is solved. Now let’s see how many sources we have in the network.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sg_sources &lt;-<span class="st"> </span><span class="kw"><a href="../reference/sources.html">sources</a></span>(sent_graph2)
sg_sources
<span class="co">#&gt; [1] 2e7967 fc7f8f 53d0b4 3301f4 c190fa d2d08f 238842</span>
<span class="co">#&gt; 98 Levels: 2e7967 cd48bf dd73b6 7ba446 642cb4 c7cd02 5b44d7 ... 486c07</span></code></pre></div>
<p>In order to be able to construct a popsnetwork object we have to provide at least the rate of infected material for each source.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sg_ext &lt;-<span class="st"> </span><span class="kw">data.frame</span>(sg_sources, <span class="kw">rep</span>(<span class="fl">0.5</span>, <span class="kw">length</span>(sg_sources)))
sg_ext
<span class="co">#&gt;   sg_sources rep.0.5..length.sg_sources..</span>
<span class="co">#&gt; 1     2e7967                          0.5</span>
<span class="co">#&gt; 2     fc7f8f                          0.5</span>
<span class="co">#&gt; 3     53d0b4                          0.5</span>
<span class="co">#&gt; 4     3301f4                          0.5</span>
<span class="co">#&gt; 5     c190fa                          0.5</span>
<span class="co">#&gt; 6     d2d08f                          0.5</span>
<span class="co">#&gt; 7     238842                          0.5</span></code></pre></div>
<p>Now we can create the network.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sg_net &lt;-<span class="st"> </span><span class="kw"><a href="../reference/popsnetwork.html">popsnetwork</a></span>(sent_graph2, sg_ext, <span class="fl">0.1</span>)
<span class="kw">plot</span>(sg_net)</code></pre></div>
<p><img src="figs-overview/unnamed-chunk-7-1.png" width="672"></p>
<p>The only thing left to do in order to run the simulation is to provide initial allele frequency distributions for the source nodes.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sg_freqs &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rep</span>(<span class="kw">c</span>(<span class="fl">0.25</span>, <span class="fl">0.25</span>, <span class="fl">0.5</span>), <span class="dt">each=</span><span class="dv">7</span>), <span class="dt">nrow=</span><span class="dv">7</span>)
sg_net_dir &lt;-<span class="st"> </span><span class="kw"><a href="../reference/popgen_dirichlet.html">popgen_dirichlet</a></span>(sg_net, <span class="fl">1.3</span>, <span class="kw">list</span>(sg_sources, sg_freqs))
sg_net_dir
<span class="co">#&gt; Nodes:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; id   infected    input   alleles...</span>
<span class="co">#&gt; 2e7967   0.55    1   0.25    0.25    0.5</span>
<span class="co">#&gt; cd48bf   0.595   1   0.485997    0.212736    0.301266</span>
<span class="co">#&gt; dd73b6   0.595   2   0.483149    0.200855    0.315996</span>
<span class="co">#&gt; 7ba446   0.595   1   0.00988648  7.32917e-05 0.99004</span>
<span class="co">#&gt; 642cb4   0.6355  1   9.70383e-05 0.159846    0.840057</span>
<span class="co">#&gt; c7cd02   0.595   2   0.0909566   0.372026    0.537017</span>
<span class="co">#&gt; 5b44d7   0.64765 1   0.0206328   0.82579 0.153577</span>
<span class="co">#&gt; 2afba4   0.6085  3   0.290593    0.185194    0.524212</span>
<span class="co">#&gt; fc7f8f   0.55    1   0.25    0.25    0.5</span>
<span class="co">#&gt; 963c41   0.714597    1   0   0.985092    0.0149077</span>
<span class="co">#&gt; f60e85   0.659193    1   0.542992    0.0111323   0.445876</span>
<span class="co">#&gt; 4941c6   0.693273    1   0.0341076   0.400247    0.565645</span>
<span class="co">#&gt; 53d0b4   0.55    1   0.25    0.25    0.5</span>
<span class="co">#&gt; 13dc78   0.67195 1   0.999665    0   0.000335109</span>
<span class="co">#&gt; 9c0e59   0.6355  1   0   1.20178e-12 1</span>
<span class="co">#&gt; 6ddfa3   0.704755    1   1   6.84813e-56 0</span>
<span class="co">#&gt; 3301f4   0.55    1   0.25    0.25    0.5</span>
<span class="co">#&gt; 874918   0.6355  1   0.266627    0.0479197   0.685454</span>
<span class="co">#&gt; f46d1e   0.6355  1   0.000238756 0.000664315 0.999097</span>
<span class="co">#&gt; 0b6e5a   0.6355  1   0.830126    2.32493e-27 0.169874</span>
<span class="co">#&gt; c190fa   0.55    1   0.25    0.25    0.5</span>
<span class="co">#&gt; 337cac   0.6355  2   0.00892236  0.886771    0.104307</span>
<span class="co">#&gt; 03eee3   0.595   1   0.775367    0.00860651  0.216026</span>
<span class="co">#&gt; c1dc98   0.64765 1   0.997589    0.000289587 0.0021212</span>
<span class="co">#&gt; a7a903   0.734279    1   1   0   0</span>
<span class="co">#&gt; d2d08f   0.55    1   0.25    0.25    0.5</span>
<span class="co">#&gt; 030327   0.64765 1   0.00871064  0.0896772   0.901612</span>
<span class="co">#&gt; 6d4b91   0.595   1   0.0007095   0.0585281   0.940762</span>
<span class="co">#&gt; 76a432   0.682885    1   1   8.26916e-197    5.2491e-110</span>
<span class="co">#&gt; 7fa3b1   0.6355  1   2.67541e-10 7.5203e-05  0.999925</span>
<span class="co">#&gt; f83f2e   0.6355  1   1.34388e-47 0   1</span>
<span class="co">#&gt; 881955   0.595   1   0.157455    0.406392    0.436153</span>
<span class="co">#&gt; e42c72   0.6355  1   0.96778 0.0254741   0.00674602</span>
<span class="co">#&gt; 4df851   0.595   1   0.0023545   0.204616    0.79303</span>
<span class="co">#&gt; d4d75e   0.6355  1   0.572086    0.12409 0.303824</span>
<span class="co">#&gt; 7be343   0.67195 1   0.675801    0.286532    0.0376665</span>
<span class="co">#&gt; 735807   0.64765 1   0.396964    0.303084    0.299952</span>
<span class="co">#&gt; 238842   0.55    1   0.25    0.25    0.5</span>
<span class="co">#&gt; 3e93ce   0.595   1   0.0625624   0.795188    0.14225</span>
<span class="co">#&gt; f7fc94   0.682885    1   6.35455e-11 0.464433    0.535567</span>
<span class="co">#&gt; 8e02f0   0.6355  1   0.000233347 0.352066    0.647701</span>
<span class="co">#&gt; b16cf0   0.64765 1   0.00609187  0.0216652   0.972243</span>
<span class="co">#&gt; 51ca98   0.682885    1   3.90568e-10 4.84275e-12 1</span>
<span class="co">#&gt; 81e071   0.665268    2   0.515583    0.29471 0.189706</span>
<span class="co">#&gt; dc72e8   0.714597    1   0   1   0</span>
<span class="co">#&gt; 4e2918   0.6355  1   6.12796e-223    0.112956    0.887044</span>
<span class="co">#&gt; 2fabc7   0.682885    1   1.84592e-13 0.999987    1.27234e-05</span>
<span class="co">#&gt; ad208a   0.595   1   0.320432    0.0795574   0.600011</span>
<span class="co">#&gt; 48f980   0.595   2   0.434639    0.35682 0.208541</span>
<span class="co">#&gt; 24dba7   0.682885    1   0   2.31564e-68 1</span>
<span class="co">#&gt; 327734   0.67195 1   0   8.71688e-06 0.999991</span>
<span class="co">#&gt; 4e8dc8   0.67195 1   0.996355    0.00364524  2.5082e-36</span>
<span class="co">#&gt; 206e37   0.64765 1   0.000407314 0.000422649 0.99917</span>
<span class="co">#&gt; 958de8   0.621325    2   0.516718    0.0677261   0.415556</span>
<span class="co">#&gt; 2d3187   0.595   1   0.121463    0.598876    0.279661</span>
<span class="co">#&gt; 7d21f1   0.6085  3   0.159013    0.356998    0.483989</span>
<span class="co">#&gt; acf7bb   0.743137    1   0   1   2.86156e-08</span>
<span class="co">#&gt; 9f5aad   0.743137    1   0   0.999799    0.00020146</span>
<span class="co">#&gt; 0b57e4   0.723946    1   9.78608e-10 0.00281439  0.997186</span>
<span class="co">#&gt; 78e5ba   0.704755    1   1   0   0</span>
<span class="co">#&gt; ca432a   0.704755    1   1   0   3.58159e-84</span>
<span class="co">#&gt; e45c54   0.704755    1   1   0   0</span>
<span class="co">#&gt; 80afad   0.685345    2   0.0179382   0.15391 0.828152</span>
<span class="co">#&gt; cede47   0.67195 1   0.466373    0.329925    0.203702</span>
<span class="co">#&gt; 82b4fc   0.67195 1   0.240769    2.95583e-06 0.759228</span>
<span class="co">#&gt; 732379   0.67195 1   0.0089043   4.80682e-07 0.991095</span>
<span class="co">#&gt; 9199be   0.67195 1   0.19733 1.89081e-14 0.80267</span>
<span class="co">#&gt; 7d3df0   0.67195 1   0   2.54572e-193    1</span>
<span class="co">#&gt; c77a84   0.67195 1   9.39011e-12 1   3.22357e-08</span>
<span class="co">#&gt; 6f5824   0.67195 1   0.000367391 0.999553    7.95435e-05</span>
<span class="co">#&gt; 3b712b   0.760852    1   1   0   0</span>
<span class="co">#&gt; 1e7431   0.682885    1   1.32478e-07 0.00473502  0.995265</span>
<span class="co">#&gt; 37aad9   0.682885    1   0.369291    0.0784425   0.552267</span>
<span class="co">#&gt; 44060b   0.714597    1   1   0   0</span>
<span class="co">#&gt; 905296   0.714597    1   1   0   0</span>
<span class="co">#&gt; f951d8   0.714597    1   1   0   0</span>
<span class="co">#&gt; b4e5d5   0.714597    1   1   0   0</span>
<span class="co">#&gt; 1b55d2   0.67195 1   0   0   1</span>
<span class="co">#&gt; a6fcaf   0.67195 1   0   0   1</span>
<span class="co">#&gt; 24876f   0.704755    1   0.493947    0.506053    2.19377e-13</span>
<span class="co">#&gt; 0fffca   0.682885    1   0.543533    0.110769    0.345698</span>
<span class="co">#&gt; 09f4a0   0.6355  1   0.389334    0.554387    0.0562782</span>
<span class="co">#&gt; 38881f   0.67195 1   0   0.516186    0.483814</span>
<span class="co">#&gt; d81c17   0.67195 1   0   0.149475    0.850525</span>
<span class="co">#&gt; 1569a5   0.67195 1   0   0.0842893   0.915711</span>
<span class="co">#&gt; 064974   0.67195 1   0   0.0796307   0.920369</span>
<span class="co">#&gt; 161814   0.67195 1   1.59677e-43 0.648286    0.351714</span>
<span class="co">#&gt; c09e12   0.67195 1   0   0.13509 0.86491</span>
<span class="co">#&gt; b08945   0.714597    1   0   0   1</span>
<span class="co">#&gt; f80b2e   0.714597    1   0   0   1</span>
<span class="co">#&gt; 35a9b6   0.698741    1   0.28513 0.516034    0.198836</span>
<span class="co">#&gt; 6e0643   0.698741    1   0.0635034   0.146838    0.789658</span>
<span class="co">#&gt; efee6b   0.698741    1   0.999825    4.02062e-06 0.000171244</span>
<span class="co">#&gt; 252679   0.698741    1   0.597089    0.386742    0.0161693</span>
<span class="co">#&gt; f59e4b   0.743137    1   0   1   0</span>
<span class="co">#&gt; ef7028   0.67195 1   0   0.00753258  0.992467</span>
<span class="co">#&gt; 1f4d22   0.714597    1   0   0   1</span>
<span class="co">#&gt; 486c07   0.704755    1   0   0   1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Links:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; from to  rate    infected</span>
<span class="co">#&gt; 2e7967   dd73b6  1   0.55</span>
<span class="co">#&gt; 2e7967   c7cd02  1   0.55</span>
<span class="co">#&gt; 2e7967   2afba4  1   0.55</span>
<span class="co">#&gt; 2e7967   4df851  1   0.55</span>
<span class="co">#&gt; 2e7967   48f980  1   0.55</span>
<span class="co">#&gt; 2e7967   2d3187  1   0.55</span>
<span class="co">#&gt; cd48bf   e42c72  1   0.595</span>
<span class="co">#&gt; cd48bf   7d21f1  1   0.595</span>
<span class="co">#&gt; dd73b6   874918  1   0.595</span>
<span class="co">#&gt; 7ba446   f83f2e  1   0.595</span>
<span class="co">#&gt; 642cb4   327734  1   0.6355</span>
<span class="co">#&gt; c7cd02   337cac  1   0.595</span>
<span class="co">#&gt; 5b44d7   f7fc94  1   0.64765</span>
<span class="co">#&gt; 5b44d7   2fabc7  1   0.64765</span>
<span class="co">#&gt; 2afba4   5b44d7  1   0.6085</span>
<span class="co">#&gt; 2afba4   c1dc98  1   0.6085</span>
<span class="co">#&gt; 2afba4   b16cf0  1   0.6085</span>
<span class="co">#&gt; 2afba4   206e37  1   0.6085</span>
<span class="co">#&gt; 2afba4   958de8  1   0.6085</span>
<span class="co">#&gt; fc7f8f   dd73b6  1   0.55</span>
<span class="co">#&gt; 963c41   acf7bb  1   0.714597</span>
<span class="co">#&gt; 963c41   9f5aad  1   0.714597</span>
<span class="co">#&gt; f60e85   4941c6  1   0.659193</span>
<span class="co">#&gt; 4941c6   0b57e4  1   0.693273</span>
<span class="co">#&gt; 53d0b4   c7cd02  1   0.55</span>
<span class="co">#&gt; 13dc78   78e5ba  1   0.67195</span>
<span class="co">#&gt; 13dc78   ca432a  1   0.67195</span>
<span class="co">#&gt; 13dc78   e45c54  1   0.67195</span>
<span class="co">#&gt; 9c0e59   80afad  1   0.6355</span>
<span class="co">#&gt; 6ddfa3   a7a903  1   0.704755</span>
<span class="co">#&gt; 3301f4   7ba446  1   0.55</span>
<span class="co">#&gt; 3301f4   03eee3  1   0.55</span>
<span class="co">#&gt; 3301f4   6d4b91  1   0.55</span>
<span class="co">#&gt; 3301f4   881955  1   0.55</span>
<span class="co">#&gt; 3301f4   3e93ce  1   0.55</span>
<span class="co">#&gt; 3301f4   ad208a  1   0.55</span>
<span class="co">#&gt; 3301f4   958de8  1   0.55</span>
<span class="co">#&gt; 3301f4   7d21f1  1   0.55</span>
<span class="co">#&gt; 874918   cede47  1   0.6355</span>
<span class="co">#&gt; 874918   82b4fc  1   0.6355</span>
<span class="co">#&gt; 874918   732379  1   0.6355</span>
<span class="co">#&gt; 874918   9199be  1   0.6355</span>
<span class="co">#&gt; f46d1e   7d3df0  1   0.6355</span>
<span class="co">#&gt; 0b6e5a   13dc78  1   0.6355</span>
<span class="co">#&gt; c190fa   48f980  1   0.55</span>
<span class="co">#&gt; 337cac   c77a84  1   0.6355</span>
<span class="co">#&gt; 337cac   6f5824  1   0.6355</span>
<span class="co">#&gt; 03eee3   0b6e5a  1   0.595</span>
<span class="co">#&gt; c1dc98   76a432  1   0.64765</span>
<span class="co">#&gt; c1dc98   81e071  1   0.64765</span>
<span class="co">#&gt; a7a903   3b712b  1   0.734279</span>
<span class="co">#&gt; d2d08f   cd48bf  1   0.55</span>
<span class="co">#&gt; 030327   1e7431  1   0.64765</span>
<span class="co">#&gt; 030327   37aad9  1   0.64765</span>
<span class="co">#&gt; 6d4b91   9c0e59  1   0.595</span>
<span class="co">#&gt; 76a432   44060b  1   0.682885</span>
<span class="co">#&gt; 76a432   905296  1   0.682885</span>
<span class="co">#&gt; 76a432   f951d8  1   0.682885</span>
<span class="co">#&gt; 76a432   b4e5d5  1   0.682885</span>
<span class="co">#&gt; 7fa3b1   1b55d2  1   0.6355</span>
<span class="co">#&gt; f83f2e   a6fcaf  1   0.6355</span>
<span class="co">#&gt; 881955   642cb4  1   0.595</span>
<span class="co">#&gt; 881955   2afba4  1   0.595</span>
<span class="co">#&gt; 881955   f46d1e  1   0.595</span>
<span class="co">#&gt; 881955   7fa3b1  1   0.595</span>
<span class="co">#&gt; e42c72   4e8dc8  1   0.6355</span>
<span class="co">#&gt; 4df851   4e2918  1   0.595</span>
<span class="co">#&gt; d4d75e   7be343  1   0.6355</span>
<span class="co">#&gt; 7be343   24876f  1   0.67195</span>
<span class="co">#&gt; 735807   0fffca  1   0.64765</span>
<span class="co">#&gt; 238842   2afba4  1   0.55</span>
<span class="co">#&gt; 238842   7d21f1  1   0.55</span>
<span class="co">#&gt; 3e93ce   09f4a0  1   0.595</span>
<span class="co">#&gt; f7fc94   963c41  1   0.682885</span>
<span class="co">#&gt; 8e02f0   38881f  1   0.6355</span>
<span class="co">#&gt; 8e02f0   d81c17  1   0.6355</span>
<span class="co">#&gt; 8e02f0   1569a5  1   0.6355</span>
<span class="co">#&gt; 8e02f0   064974  1   0.6355</span>
<span class="co">#&gt; 8e02f0   161814  1   0.6355</span>
<span class="co">#&gt; 8e02f0   c09e12  1   0.6355</span>
<span class="co">#&gt; b16cf0   51ca98  1   0.64765</span>
<span class="co">#&gt; 51ca98   b08945  1   0.682885</span>
<span class="co">#&gt; 51ca98   f80b2e  1   0.682885</span>
<span class="co">#&gt; 81e071   80afad  1   0.665268</span>
<span class="co">#&gt; 81e071   35a9b6  1   0.665268</span>
<span class="co">#&gt; 81e071   6e0643  1   0.665268</span>
<span class="co">#&gt; 81e071   efee6b  1   0.665268</span>
<span class="co">#&gt; 81e071   252679  1   0.665268</span>
<span class="co">#&gt; dc72e8   f59e4b  1   0.714597</span>
<span class="co">#&gt; 4e2918   ef7028  1   0.6355</span>
<span class="co">#&gt; 2fabc7   dc72e8  1   0.682885</span>
<span class="co">#&gt; ad208a   8e02f0  1   0.595</span>
<span class="co">#&gt; 48f980   d4d75e  1   0.595</span>
<span class="co">#&gt; 24dba7   1f4d22  1   0.682885</span>
<span class="co">#&gt; 327734   486c07  1   0.67195</span>
<span class="co">#&gt; 4e8dc8   6ddfa3  1   0.67195</span>
<span class="co">#&gt; 206e37   24dba7  1   0.64765</span>
<span class="co">#&gt; 958de8   f60e85  1   0.621325</span>
<span class="co">#&gt; 2d3187   337cac  1   0.595</span>
<span class="co">#&gt; 7d21f1   030327  1   0.6085</span>
<span class="co">#&gt; 7d21f1   735807  1   0.6085</span>
<span class="co">#&gt; 7d21f1   81e071  1   0.6085</span></code></pre></div>
<p>Now we are ready to draw lots of isolates.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sg_sinks &lt;-<span class="st"> </span><span class="kw"><a href="../reference/sinks.html">sinks</a></span>(sent_graph2)
<span class="kw"><a href="../reference/draw_isolates.html">draw_isolates</a></span>(sg_net_dir, <span class="kw">data.frame</span>(sg_sinks, <span class="kw">rep</span>(<span class="dv">20</span>, <span class="kw">length</span>(sg_sinks))))
<span class="co">#&gt;      node allele_0 allele_1 allele_2</span>
<span class="co">#&gt; 1  acf7bb        0       20        0</span>
<span class="co">#&gt; 2  9f5aad        0       20        0</span>
<span class="co">#&gt; 3  0b57e4        0        0       20</span>
<span class="co">#&gt; 4  78e5ba       20        0        0</span>
<span class="co">#&gt; 5  ca432a       20        0        0</span>
<span class="co">#&gt; 6  e45c54       20        0        0</span>
<span class="co">#&gt; 7  80afad        0        1       19</span>
<span class="co">#&gt; 8  cede47        9        5        6</span>
<span class="co">#&gt; 9  82b4fc        5        0       15</span>
<span class="co">#&gt; 10 732379        1        0       19</span>
<span class="co">#&gt; 11 9199be        3        0       17</span>
<span class="co">#&gt; 12 7d3df0        0        0       20</span>
<span class="co">#&gt; 13 c77a84        0       20        0</span>
<span class="co">#&gt; 14 6f5824        0       20        0</span>
<span class="co">#&gt; 15 3b712b       20        0        0</span>
<span class="co">#&gt; 16 1e7431        0        0       20</span>
<span class="co">#&gt; 17 37aad9        5        1       14</span>
<span class="co">#&gt; 18 44060b       20        0        0</span>
<span class="co">#&gt; 19 905296       20        0        0</span>
<span class="co">#&gt; 20 f951d8       20        0        0</span>
<span class="co">#&gt; 21 b4e5d5       20        0        0</span>
<span class="co">#&gt; 22 1b55d2        0        0       20</span>
<span class="co">#&gt; 23 a6fcaf        0        0       20</span>
<span class="co">#&gt; 24 24876f        9       11        0</span>
<span class="co">#&gt; 25 0fffca       10        1        9</span>
<span class="co">#&gt; 26 09f4a0       10       10        0</span>
<span class="co">#&gt; 27 38881f        0       10       10</span>
<span class="co">#&gt; 28 d81c17        0        1       19</span>
<span class="co">#&gt; 29 1569a5        0        2       18</span>
<span class="co">#&gt; 30 064974        0        5       15</span>
<span class="co">#&gt; 31 161814        0       14        6</span>
<span class="co">#&gt; 32 c09e12        0        2       18</span>
<span class="co">#&gt; 33 b08945        0        0       20</span>
<span class="co">#&gt; 34 f80b2e        0        0       20</span>
<span class="co">#&gt; 35 35a9b6        5        8        7</span>
<span class="co">#&gt; 36 6e0643        3        3       14</span>
<span class="co">#&gt; 37 efee6b       20        0        0</span>
<span class="co">#&gt; 38 252679       10        9        1</span>
<span class="co">#&gt; 39 f59e4b        0       20        0</span>
<span class="co">#&gt; 40 ef7028        0        0       20</span>
<span class="co">#&gt; 41 1f4d22        0        0       20</span>
<span class="co">#&gt; 42 486c07        0        0       20</span></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#installing-the-package">Installing the package</a></li>
      <li><a href="#what-does-it-do">What does it do?</a></li>
      <li>
<a href="#a-quick-overview">A quick overview</a><ul class="nav nav-pills nav-stacked">
<li><a href="#preparing-the-network">Preparing the network</a></li>
      <li><a href="#injecting-initial-populations-and-simulating-spread">Injecting initial populations and simulating spread</a></li>
      <li><a href="#drawing-samples">Drawing samples</a></li>
      </ul>
</li>
      <li><a href="#an-example-using-real-data">An example using real data</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Martin Hinsch.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>

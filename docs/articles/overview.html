<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Overview of the rpathsonpaths package • rpathsonpaths</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">rpathsonpaths</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/overview.html">Overview of the rpathsonpaths package</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/mhinsch/rpathsonpaths">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Overview of the rpathsonpaths package</h1>
                        <h4 class="author">Martin Hinsch</h4>
            
            <h4 class="date">2017-11-17</h4>
          </div>

    
    
<div class="contents">
<p><em>rpathsonpaths</em> provides functions to simulate the spread of biological organisms on a substrate that is itself moving through a network structure (e.g. pathogens in a food distribution network or infections in migrating animals). This vignette provides an overview of current features. It largely reproduces the content of <code>REAME.md</code>.</p>
<p><br></p>
<div id="installing-the-package" class="section level1">
<h1 class="hasAnchor">
<a href="#installing-the-package" class="anchor"></a>Installing the package</h1>
<p><em>rpathsonpaths</em> is currently only available on github.</p>
<p>Prerequisites:</p>
<ul>
<li><p>C++ boost libraries</p></li>
<li><p><em>Rcpp</em> (&gt;= 0.12.9)</p></li>
</ul>
<p>Some of the functionality will also require the <em>igraph</em> package.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">devtools::<span class="kw">install_github</span>(<span class="st">"reconhub/incidence"</span>)</code></pre></div>
<p>Note that this requires the package <em>devtools</em> to be installed.</p>
<p><br></p>
</div>
<div id="what-does-it-do" class="section level1">
<h1 class="hasAnchor">
<a href="#what-does-it-do" class="anchor"></a>What does it do?</h1>
<p><em>rpathsonpaths</em> provides functions to simulate the spread of a population in a substrate that itself is transported across a directed graph. The paradigmatic example is the spread of pathogens in food transport networks, but other instances might include for examples infections in migrating animals.</p>
<p>The most important functions include:</p>
<ul>
<li><p><strong><code>popsnetwork</code></strong>: create a network object from an edgelist (describing the transport graph) and a list of external sources.</p></li>
<li><p><strong><code>set_allele_freq</code></strong>: set the population composition in source nodes.</p></li>
<li><p><strong><code>popgen_dirichlet</code></strong>: simulate spread of genetic material on the network using a Dirichlet distribution to approximate genetic drift.</p></li>
<li><p><strong><code>draw_isolates</code></strong>: draw a number of random individuals from a set of nodes using the simulated allele frequencies.</p></li>
<li><p><strong><code>plot</code></strong>: plot a <em>popsnetwork</em> object (currently uses <em>igraph</em>, but more backends are planned).</p></li>
</ul>
<p><br></p>
</div>
<div id="a-quick-overview" class="section level1">
<h1 class="hasAnchor">
<a href="#a-quick-overview" class="anchor"></a>A quick overview</h1>
<p>The following worked example provides a brief overview of the package’s functionalities.</p>
<div id="preparing-the-network" class="section level2">
<h2 class="hasAnchor">
<a href="#preparing-the-network" class="anchor"></a>Preparing the network</h2>
<p>First, we prepare an edge list describing the network, and the initial state of the source nodes:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(rpathsonpaths)

inp &lt;-<span class="st"> </span><span class="kw">c</span>(0L, 0L, 1L, 2L, 3L, 1L, 5L)
outp &lt;-<span class="st"> </span><span class="kw">c</span>(1L, 2L, 3L, 3L, 4L, 4L, 2L)
rates &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="fl">1.5</span>, <span class="fl">0.5</span>, <span class="fl">0.1</span>, <span class="dv">1</span>, <span class="fl">0.1</span>, <span class="fl">0.5</span>)
edgelist &lt;-<span class="st"> </span><span class="kw">data.frame</span>(inp, outp, rates)
ext &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">c</span>(0L, 5L), <span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>))</code></pre></div>
<p>Now we can create a <em>popsnetwork</em> object:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
netraw &lt;-<span class="st"> </span><span class="kw"><a href="../reference/popsnetwork.html">popsnetwork</a></span>(edgelist, ext, <span class="fl">0.1</span>)
netraw
<span class="co">#&gt; Nodes:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; id   infected    input   alleles...</span>
<span class="co">#&gt; 0    0.55    1</span>
<span class="co">#&gt; 1    0.595   1</span>
<span class="co">#&gt; 2    0.595   2</span>
<span class="co">#&gt; 3    0.6355  0.6</span>
<span class="co">#&gt; 4    0.668636    1.1</span>
<span class="co">#&gt; 5    0.55    1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Links:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; from to  rate    infected</span>
<span class="co">#&gt; 0    1   1   0.55</span>
<span class="co">#&gt; 0    2   1.5 0.55</span>
<span class="co">#&gt; 1    3   0.5 0.595</span>
<span class="co">#&gt; 2    3   0.1 0.595</span>
<span class="co">#&gt; 3    4   1   0.6355</span>
<span class="co">#&gt; 1    4   0.1 0.595</span>
<span class="co">#&gt; 5    2   0.5 0.55</span>
<span class="kw">plot</span>(netraw)
<span class="co">#&gt; Loading required namespace: igraph</span></code></pre></div>
<p><img src="figs-overview/popsnetwork-1.png" width="672"></p>
</div>
<div id="injecting-initial-populations-and-simulating-spread" class="section level2">
<h2 class="hasAnchor">
<a href="#injecting-initial-populations-and-simulating-spread" class="anchor"></a>Injecting initial populations and simulating spread</h2>
<p>We set up the initial populations of the source nodes:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">freqs &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="fl">0.1</span>, <span class="fl">0.4</span>, <span class="fl">0.3</span>, <span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="fl">0.4</span>, <span class="fl">0.3</span>), <span class="dt">ncol=</span><span class="dv">4</span>, <span class="dt">nrow=</span><span class="dv">2</span>)
netini &lt;-<span class="st"> </span><span class="kw"><a href="../reference/set_allele_freqs.html">set_allele_freqs</a></span>(netraw, <span class="kw">list</span>(<span class="kw">c</span>(0L, 5L), freqs))
netini
<span class="co">#&gt; Nodes:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; id   infected    input   alleles...</span>
<span class="co">#&gt; 0    0.55    1   0.1 0.3 0.2 0.4</span>
<span class="co">#&gt; 1    0.595   1   0   0   0   0</span>
<span class="co">#&gt; 2    0.595   2   0   0   0   0</span>
<span class="co">#&gt; 3    0.6355  0.6 0   0   0   0</span>
<span class="co">#&gt; 4    0.668636    1.1 0   0   0   0</span>
<span class="co">#&gt; 5    0.55    1   0.4 0.1 0.2 0.3</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Links:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; from to  rate    infected</span>
<span class="co">#&gt; 0    1   1   0.55</span>
<span class="co">#&gt; 0    2   1.5 0.55</span>
<span class="co">#&gt; 1    3   0.5 0.595</span>
<span class="co">#&gt; 2    3   0.1 0.595</span>
<span class="co">#&gt; 3    4   1   0.6355</span>
<span class="co">#&gt; 1    4   0.1 0.595</span>
<span class="co">#&gt; 5    2   0.5 0.55</span></code></pre></div>
<p>Now we are ready to simulate spread of genetic material in the network. Note that every call to popgen_dirichlet will generally produce a different allele frequency distribution.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">netdir1 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/popgen_dirichlet.html">popgen_dirichlet</a></span>(netini, <span class="fl">1.7</span>)
netdir1
<span class="co">#&gt; Nodes:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; id   infected    input   alleles...</span>
<span class="co">#&gt; 0    0.55    1   0.1 0.3 0.2 0.4</span>
<span class="co">#&gt; 1    0.595   1   0.837157    0.00850275  0.0986441   0.0556961</span>
<span class="co">#&gt; 2    0.595   2   0.0178962   0.785107    0.0558988   0.141098</span>
<span class="co">#&gt; 3    0.6355  0.6 0.842803    0.155985    0.000202123 0.00100959</span>
<span class="co">#&gt; 4    0.668636    1.1 0.887792    0.112208    4.21474e-08 9.57014e-30</span>
<span class="co">#&gt; 5    0.55    1   0.4 0.1 0.2 0.3</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Links:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; from to  rate    infected</span>
<span class="co">#&gt; 0    1   1   0.55</span>
<span class="co">#&gt; 0    2   1.5 0.55</span>
<span class="co">#&gt; 1    3   0.5 0.595</span>
<span class="co">#&gt; 2    3   0.1 0.595</span>
<span class="co">#&gt; 3    4   1   0.6355</span>
<span class="co">#&gt; 1    4   0.1 0.595</span>
<span class="co">#&gt; 5    2   0.5 0.55</span>
netdir2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/popgen_dirichlet.html">popgen_dirichlet</a></span>(netini, <span class="fl">1.7</span>)
netdir2
<span class="co">#&gt; Nodes:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; id   infected    input   alleles...</span>
<span class="co">#&gt; 0    0.55    1   0.1 0.3 0.2 0.4</span>
<span class="co">#&gt; 1    0.595   1   0.476441    0.00152199  0.0184385   0.503599</span>
<span class="co">#&gt; 2    0.595   2   0.107908    0.216622    0.050346    0.625123</span>
<span class="co">#&gt; 3    0.6355  0.6 0.0686419   0.16394 0.393702    0.373716</span>
<span class="co">#&gt; 4    0.668636    1.1 0.0380756   0.108918    0.754659    0.0983479</span>
<span class="co">#&gt; 5    0.55    1   0.4 0.1 0.2 0.3</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Links:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; from to  rate    infected</span>
<span class="co">#&gt; 0    1   1   0.55</span>
<span class="co">#&gt; 0    2   1.5 0.55</span>
<span class="co">#&gt; 1    3   0.5 0.595</span>
<span class="co">#&gt; 2    3   0.1 0.595</span>
<span class="co">#&gt; 3    4   1   0.6355</span>
<span class="co">#&gt; 1    4   0.1 0.595</span>
<span class="co">#&gt; 5    2   0.5 0.55</span></code></pre></div>
</div>
<div id="drawing-samples" class="section level2">
<h2 class="hasAnchor">
<a href="#drawing-samples" class="anchor"></a>Drawing samples</h2>
<p>Finally we can draw samples from our simulated population.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">samplconf &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">c</span>(2L, 4L), <span class="kw">c</span>(10L, 10L))
<span class="kw"><a href="../reference/draw_isolates.html">draw_isolates</a></span>(netdir1, samplconf)
<span class="co">#&gt;   node allele_0 allele_1 allele_2 allele_3</span>
<span class="co">#&gt; 1    2        0        8        0        2</span>
<span class="co">#&gt; 2    4        9        1        0        0</span>
<span class="kw"><a href="../reference/draw_isolates.html">draw_isolates</a></span>(netdir2, samplconf)
<span class="co">#&gt;   node allele_0 allele_1 allele_2 allele_3</span>
<span class="co">#&gt; 1    2        1        1        0        8</span>
<span class="co">#&gt; 2    4        1        0        9        0</span></code></pre></div>
</div>
</div>
<div id="an-example-using-real-data" class="section level1">
<h1 class="hasAnchor">
<a href="#an-example-using-real-data" class="anchor"></a>An example using real data</h1>
<p>Let’s load the data:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(outbreaks)
<span class="kw">data</span>(s_enteritidis_pt59)
raw_graph =<span class="st"> </span>s_enteritidis_pt59$graph
sent_graph =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">from=</span>raw_graph[[<span class="dv">1</span>]], <span class="dt">to=</span>raw_graph[[<span class="dv">2</span>]])</code></pre></div>
<p>Just in case we do some sanity checks.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(rpathsonpaths)
<span class="kw"><a href="../reference/colour_network.html">colour_network</a></span>(sent_graph)
<span class="co">#&gt;   [1] 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3</span>
<span class="co">#&gt;  [36] 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3</span>
<span class="co">#&gt;  [71] 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3</span>
<span class="kw"><a href="../reference/cycles.html">cycles</a></span>(sent_graph)
<span class="co">#&gt; [1] TRUE</span></code></pre></div>
<p>Ok, we do have one contiguous network. Unfortunately, however, there’s a cycle. This will make rpathsonpaths very unhappy so we have to get rid of it.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/cycles.html">cycles</a></span>(sent_graph, <span class="ot">TRUE</span>)
<span class="co">#&gt; [[1]]</span>
<span class="co">#&gt; [1] 0b6e5a 13dc78</span>
<span class="co">#&gt; 98 Levels: 2e7967 cd48bf dd73b6 7ba446 642cb4 c7cd02 5b44d7 ... 486c07</span>
sent_graph2 &lt;-<span class="st"> </span><span class="kw">subset</span>(sent_graph, !(from==<span class="st">"13dc78"</span> &amp;<span class="st"> </span>to==<span class="st">"0b6e5a"</span>))
<span class="kw"><a href="../reference/cycles.html">cycles</a></span>(sent_graph2)
<span class="co">#&gt; [1] FALSE</span></code></pre></div>
<p>Ok, this is solved. Now let’s see how many sources we have in the network.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sg_sources &lt;-<span class="st"> </span><span class="kw"><a href="../reference/sources.html">sources</a></span>(sent_graph2)
sg_sources
<span class="co">#&gt; [1] 2e7967 fc7f8f 53d0b4 3301f4 c190fa d2d08f 238842</span>
<span class="co">#&gt; 98 Levels: 2e7967 cd48bf dd73b6 7ba446 642cb4 c7cd02 5b44d7 ... 486c07</span></code></pre></div>
<p>In order to be able to construct a popsnetwork object we have to provide at least the rate of infected material for each source.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sg_ext &lt;-<span class="st"> </span><span class="kw">data.frame</span>(sg_sources, <span class="kw">rep</span>(<span class="fl">0.5</span>, <span class="kw">length</span>(sg_sources)))
sg_ext
<span class="co">#&gt;   sg_sources rep.0.5..length.sg_sources..</span>
<span class="co">#&gt; 1     2e7967                          0.5</span>
<span class="co">#&gt; 2     fc7f8f                          0.5</span>
<span class="co">#&gt; 3     53d0b4                          0.5</span>
<span class="co">#&gt; 4     3301f4                          0.5</span>
<span class="co">#&gt; 5     c190fa                          0.5</span>
<span class="co">#&gt; 6     d2d08f                          0.5</span>
<span class="co">#&gt; 7     238842                          0.5</span></code></pre></div>
<p>Now we can create the network.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sg_net &lt;-<span class="st"> </span><span class="kw"><a href="../reference/popsnetwork.html">popsnetwork</a></span>(sent_graph2, sg_ext, <span class="fl">0.1</span>)
<span class="kw">plot</span>(sg_net)</code></pre></div>
<p><img src="figs-overview/unnamed-chunk-7-1.png" width="672"></p>
<p>The only thing left to do in order to run the simulation is to provide initial allele frequency distributions for the source nodes.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sg_freqs &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rep</span>(<span class="kw">c</span>(<span class="fl">0.25</span>, <span class="fl">0.25</span>, <span class="fl">0.5</span>), <span class="dt">each=</span><span class="dv">7</span>), <span class="dt">nrow=</span><span class="dv">7</span>)
sg_net_dir &lt;-<span class="st"> </span><span class="kw"><a href="../reference/popgen_dirichlet.html">popgen_dirichlet</a></span>(sg_net, <span class="fl">1.3</span>, <span class="kw">list</span>(sg_sources, sg_freqs))
sg_net_dir
<span class="co">#&gt; Nodes:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; id   infected    input   alleles...</span>
<span class="co">#&gt; 2e7967   0.55    1   0.25    0.25    0.5</span>
<span class="co">#&gt; cd48bf   0.595   1   0.0272441   0.0766624   0.896093</span>
<span class="co">#&gt; dd73b6   0.595   2   0.376247    0.184873    0.43888</span>
<span class="co">#&gt; 7ba446   0.595   1   0.018848    0.0679983   0.913154</span>
<span class="co">#&gt; 642cb4   0.6355  1   1.34364e-11 0.522324    0.477676</span>
<span class="co">#&gt; c7cd02   0.595   2   0.874959    0.00869683  0.116344</span>
<span class="co">#&gt; 5b44d7   0.64765 1   0.00269155  0.175988    0.821321</span>
<span class="co">#&gt; 2afba4   0.6085  3   0.157356    0.436763    0.40588</span>
<span class="co">#&gt; fc7f8f   0.55    1   0.25    0.25    0.5</span>
<span class="co">#&gt; 963c41   0.714597    1   0   4.96189e-06 0.999995</span>
<span class="co">#&gt; f60e85   0.659193    1   0.27221 0.0195454   0.708244</span>
<span class="co">#&gt; 4941c6   0.693273    1   0.00249202  8.17182e-57 0.997508</span>
<span class="co">#&gt; 53d0b4   0.55    1   0.25    0.25    0.5</span>
<span class="co">#&gt; 13dc78   0.67195 1   0   0   1</span>
<span class="co">#&gt; 9c0e59   0.6355  1   0.939844    2.21562e-05 0.0601334</span>
<span class="co">#&gt; 6ddfa3   0.704755    1   0   0   1</span>
<span class="co">#&gt; 3301f4   0.55    1   0.25    0.25    0.5</span>
<span class="co">#&gt; 874918   0.6355  1   0.169496    0.531032    0.299472</span>
<span class="co">#&gt; f46d1e   0.6355  1   1.11755e-07 0.763004    0.236996</span>
<span class="co">#&gt; 0b6e5a   0.6355  1   3.5763e-132 7.08864e-14 1</span>
<span class="co">#&gt; c190fa   0.55    1   0.25    0.25    0.5</span>
<span class="co">#&gt; 337cac   0.6355  2   0.879244    5.10599e-43 0.120756</span>
<span class="co">#&gt; 03eee3   0.595   1   0.00191814  0.0291163   0.968966</span>
<span class="co">#&gt; c1dc98   0.64765 1   0.687156    0.124653    0.18819</span>
<span class="co">#&gt; a7a903   0.734279    1   0   0   1</span>
<span class="co">#&gt; d2d08f   0.55    1   0.25    0.25    0.5</span>
<span class="co">#&gt; 030327   0.64765 1   0.000683647 0.0156849   0.983631</span>
<span class="co">#&gt; 6d4b91   0.595   1   0.815195    0.0247967   0.160008</span>
<span class="co">#&gt; 76a432   0.682885    1   0.832317    0.00626513  0.161418</span>
<span class="co">#&gt; 7fa3b1   0.6355  1   4.36001e-06 0.338779    0.661217</span>
<span class="co">#&gt; f83f2e   0.6355  1   1.49906e-07 0.00179279  0.998207</span>
<span class="co">#&gt; 881955   0.595   1   0.0577065   0.629404    0.312889</span>
<span class="co">#&gt; e42c72   0.6355  1   5.90451e-07 9.9112e-18  0.999999</span>
<span class="co">#&gt; 4df851   0.595   1   0.421857    0.0931925   0.48495</span>
<span class="co">#&gt; d4d75e   0.6355  1   1.07027e-05 0.503832    0.496157</span>
<span class="co">#&gt; 7be343   0.67195 1   0   0.587814    0.412186</span>
<span class="co">#&gt; 735807   0.64765 1   0.149312    0.795603    0.0550846</span>
<span class="co">#&gt; 238842   0.55    1   0.25    0.25    0.5</span>
<span class="co">#&gt; 3e93ce   0.595   1   0.034677    0.814897    0.150426</span>
<span class="co">#&gt; f7fc94   0.682885    1   1.09277e-59 0.088714    0.911286</span>
<span class="co">#&gt; 8e02f0   0.6355  1   0.880141    4.47987e-08 0.119858</span>
<span class="co">#&gt; b16cf0   0.64765 1   0.0339695   0.107855    0.858175</span>
<span class="co">#&gt; 51ca98   0.682885    1   0.00396644  0.147643    0.848391</span>
<span class="co">#&gt; 81e071   0.665268    2   0.547908    0.336522    0.11557</span>
<span class="co">#&gt; dc72e8   0.714597    1   0   0.181484    0.818516</span>
<span class="co">#&gt; 4e2918   0.6355  1   0.320593    0.19133 0.488077</span>
<span class="co">#&gt; 2fabc7   0.682885    1   2.09842e-41 0.576381    0.423619</span>
<span class="co">#&gt; ad208a   0.595   1   0.689905    0.122467    0.187628</span>
<span class="co">#&gt; 48f980   0.595   2   0.109911    0.429238    0.460851</span>
<span class="co">#&gt; 24dba7   0.682885    1   0.0105219   0.989478    5.28768e-13</span>
<span class="co">#&gt; 327734   0.67195 1   0   0.0512759   0.948724</span>
<span class="co">#&gt; 4e8dc8   0.67195 1   0   0   1</span>
<span class="co">#&gt; 206e37   0.64765 1   0.055142    0.936751    0.00810665</span>
<span class="co">#&gt; 958de8   0.621325    2   0.262495    0.0838205   0.653684</span>
<span class="co">#&gt; 2d3187   0.595   1   0.764977    0.000308961 0.234714</span>
<span class="co">#&gt; 7d21f1   0.6085  3   0.123031    0.584593    0.292376</span>
<span class="co">#&gt; acf7bb   0.743137    1   0   0   1</span>
<span class="co">#&gt; 9f5aad   0.743137    1   0   0   1</span>
<span class="co">#&gt; 0b57e4   0.723946    1   4.67954e-21 0   1</span>
<span class="co">#&gt; 78e5ba   0.704755    1   0   0   1</span>
<span class="co">#&gt; ca432a   0.704755    1   0   0   1</span>
<span class="co">#&gt; e45c54   0.704755    1   0   0   1</span>
<span class="co">#&gt; 80afad   0.685345    2   0.977111    0.0227867   0.00010212</span>
<span class="co">#&gt; cede47   0.67195 1   0.000326656 0.982771    0.0169025</span>
<span class="co">#&gt; 82b4fc   0.67195 1   0.000355996 0.961161    0.0384825</span>
<span class="co">#&gt; 732379   0.67195 1   0.0114431   0.733406    0.25515</span>
<span class="co">#&gt; 9199be   0.67195 1   0.119862    0.880138    3.10077e-07</span>
<span class="co">#&gt; 7d3df0   0.67195 1   0   0.880436    0.119564</span>
<span class="co">#&gt; c77a84   0.67195 1   0.998456    0   0.00154389</span>
<span class="co">#&gt; 6f5824   0.67195 1   0.999999    0   1.32969e-06</span>
<span class="co">#&gt; 3b712b   0.760852    1   0   0   1</span>
<span class="co">#&gt; 1e7431   0.682885    1   7.27112e-22 1.64477e-06 0.999998</span>
<span class="co">#&gt; 37aad9   0.682885    1   2.77932e-57 1.92319e-11 1</span>
<span class="co">#&gt; 44060b   0.714597    1   0.999997    1.37582e-22 2.61045e-06</span>
<span class="co">#&gt; 905296   0.714597    1   0.896439    6.65955e-295    0.103561</span>
<span class="co">#&gt; f951d8   0.714597    1   0.898881    8.91859e-24 0.101119</span>
<span class="co">#&gt; b4e5d5   0.714597    1   0.056641    3.64403e-39 0.943359</span>
<span class="co">#&gt; 1b55d2   0.67195 1   0   0.00896984  0.99103</span>
<span class="co">#&gt; a6fcaf   0.67195 1   0   0   1</span>
<span class="co">#&gt; 24876f   0.704755    1   0   0.446697    0.553303</span>
<span class="co">#&gt; 0fffca   0.682885    1   0.982613    0.00809204  0.009295</span>
<span class="co">#&gt; 09f4a0   0.6355  1   1.80647e-22 0.14193 0.85807</span>
<span class="co">#&gt; 38881f   0.67195 1   0.987379    0   0.0126215</span>
<span class="co">#&gt; d81c17   0.67195 1   0.961975    0   0.0380247</span>
<span class="co">#&gt; 1569a5   0.67195 1   0.866039    0   0.133961</span>
<span class="co">#&gt; 064974   0.67195 1   0.999986    0   1.39771e-05</span>
<span class="co">#&gt; 161814   0.67195 1   0.999775    0   0.000225498</span>
<span class="co">#&gt; c09e12   0.67195 1   0.914505    0   0.0854953</span>
<span class="co">#&gt; b08945   0.714597    1   3.80698e-98 0.130481    0.869519</span>
<span class="co">#&gt; f80b2e   0.714597    1   9.47026e-22 8.48727e-08 1</span>
<span class="co">#&gt; 35a9b6   0.698741    1   0.99858 0.00135583  6.44611e-05</span>
<span class="co">#&gt; 6e0643   0.698741    1   0.772203    0.00934511  0.218452</span>
<span class="co">#&gt; efee6b   0.698741    1   0.889901    0.0025877   0.107512</span>
<span class="co">#&gt; 252679   0.698741    1   0.0989398   0.468234    0.432827</span>
<span class="co">#&gt; f59e4b   0.743137    1   0   0.295939    0.704061</span>
<span class="co">#&gt; ef7028   0.67195 1   0.299921    0.0493472   0.650731</span>
<span class="co">#&gt; 1f4d22   0.714597    1   1.05388e-23 1   0</span>
<span class="co">#&gt; 486c07   0.704755    1   0   1.48969e-09 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Links:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; from to  rate    infected</span>
<span class="co">#&gt; 2e7967   dd73b6  1   0.55</span>
<span class="co">#&gt; 2e7967   c7cd02  1   0.55</span>
<span class="co">#&gt; 2e7967   2afba4  1   0.55</span>
<span class="co">#&gt; 2e7967   4df851  1   0.55</span>
<span class="co">#&gt; 2e7967   48f980  1   0.55</span>
<span class="co">#&gt; 2e7967   2d3187  1   0.55</span>
<span class="co">#&gt; cd48bf   e42c72  1   0.595</span>
<span class="co">#&gt; cd48bf   7d21f1  1   0.595</span>
<span class="co">#&gt; dd73b6   874918  1   0.595</span>
<span class="co">#&gt; 7ba446   f83f2e  1   0.595</span>
<span class="co">#&gt; 642cb4   327734  1   0.6355</span>
<span class="co">#&gt; c7cd02   337cac  1   0.595</span>
<span class="co">#&gt; 5b44d7   f7fc94  1   0.64765</span>
<span class="co">#&gt; 5b44d7   2fabc7  1   0.64765</span>
<span class="co">#&gt; 2afba4   5b44d7  1   0.6085</span>
<span class="co">#&gt; 2afba4   c1dc98  1   0.6085</span>
<span class="co">#&gt; 2afba4   b16cf0  1   0.6085</span>
<span class="co">#&gt; 2afba4   206e37  1   0.6085</span>
<span class="co">#&gt; 2afba4   958de8  1   0.6085</span>
<span class="co">#&gt; fc7f8f   dd73b6  1   0.55</span>
<span class="co">#&gt; 963c41   acf7bb  1   0.714597</span>
<span class="co">#&gt; 963c41   9f5aad  1   0.714597</span>
<span class="co">#&gt; f60e85   4941c6  1   0.659193</span>
<span class="co">#&gt; 4941c6   0b57e4  1   0.693273</span>
<span class="co">#&gt; 53d0b4   c7cd02  1   0.55</span>
<span class="co">#&gt; 13dc78   78e5ba  1   0.67195</span>
<span class="co">#&gt; 13dc78   ca432a  1   0.67195</span>
<span class="co">#&gt; 13dc78   e45c54  1   0.67195</span>
<span class="co">#&gt; 9c0e59   80afad  1   0.6355</span>
<span class="co">#&gt; 6ddfa3   a7a903  1   0.704755</span>
<span class="co">#&gt; 3301f4   7ba446  1   0.55</span>
<span class="co">#&gt; 3301f4   03eee3  1   0.55</span>
<span class="co">#&gt; 3301f4   6d4b91  1   0.55</span>
<span class="co">#&gt; 3301f4   881955  1   0.55</span>
<span class="co">#&gt; 3301f4   3e93ce  1   0.55</span>
<span class="co">#&gt; 3301f4   ad208a  1   0.55</span>
<span class="co">#&gt; 3301f4   958de8  1   0.55</span>
<span class="co">#&gt; 3301f4   7d21f1  1   0.55</span>
<span class="co">#&gt; 874918   cede47  1   0.6355</span>
<span class="co">#&gt; 874918   82b4fc  1   0.6355</span>
<span class="co">#&gt; 874918   732379  1   0.6355</span>
<span class="co">#&gt; 874918   9199be  1   0.6355</span>
<span class="co">#&gt; f46d1e   7d3df0  1   0.6355</span>
<span class="co">#&gt; 0b6e5a   13dc78  1   0.6355</span>
<span class="co">#&gt; c190fa   48f980  1   0.55</span>
<span class="co">#&gt; 337cac   c77a84  1   0.6355</span>
<span class="co">#&gt; 337cac   6f5824  1   0.6355</span>
<span class="co">#&gt; 03eee3   0b6e5a  1   0.595</span>
<span class="co">#&gt; c1dc98   76a432  1   0.64765</span>
<span class="co">#&gt; c1dc98   81e071  1   0.64765</span>
<span class="co">#&gt; a7a903   3b712b  1   0.734279</span>
<span class="co">#&gt; d2d08f   cd48bf  1   0.55</span>
<span class="co">#&gt; 030327   1e7431  1   0.64765</span>
<span class="co">#&gt; 030327   37aad9  1   0.64765</span>
<span class="co">#&gt; 6d4b91   9c0e59  1   0.595</span>
<span class="co">#&gt; 76a432   44060b  1   0.682885</span>
<span class="co">#&gt; 76a432   905296  1   0.682885</span>
<span class="co">#&gt; 76a432   f951d8  1   0.682885</span>
<span class="co">#&gt; 76a432   b4e5d5  1   0.682885</span>
<span class="co">#&gt; 7fa3b1   1b55d2  1   0.6355</span>
<span class="co">#&gt; f83f2e   a6fcaf  1   0.6355</span>
<span class="co">#&gt; 881955   642cb4  1   0.595</span>
<span class="co">#&gt; 881955   2afba4  1   0.595</span>
<span class="co">#&gt; 881955   f46d1e  1   0.595</span>
<span class="co">#&gt; 881955   7fa3b1  1   0.595</span>
<span class="co">#&gt; e42c72   4e8dc8  1   0.6355</span>
<span class="co">#&gt; 4df851   4e2918  1   0.595</span>
<span class="co">#&gt; d4d75e   7be343  1   0.6355</span>
<span class="co">#&gt; 7be343   24876f  1   0.67195</span>
<span class="co">#&gt; 735807   0fffca  1   0.64765</span>
<span class="co">#&gt; 238842   2afba4  1   0.55</span>
<span class="co">#&gt; 238842   7d21f1  1   0.55</span>
<span class="co">#&gt; 3e93ce   09f4a0  1   0.595</span>
<span class="co">#&gt; f7fc94   963c41  1   0.682885</span>
<span class="co">#&gt; 8e02f0   38881f  1   0.6355</span>
<span class="co">#&gt; 8e02f0   d81c17  1   0.6355</span>
<span class="co">#&gt; 8e02f0   1569a5  1   0.6355</span>
<span class="co">#&gt; 8e02f0   064974  1   0.6355</span>
<span class="co">#&gt; 8e02f0   161814  1   0.6355</span>
<span class="co">#&gt; 8e02f0   c09e12  1   0.6355</span>
<span class="co">#&gt; b16cf0   51ca98  1   0.64765</span>
<span class="co">#&gt; 51ca98   b08945  1   0.682885</span>
<span class="co">#&gt; 51ca98   f80b2e  1   0.682885</span>
<span class="co">#&gt; 81e071   80afad  1   0.665268</span>
<span class="co">#&gt; 81e071   35a9b6  1   0.665268</span>
<span class="co">#&gt; 81e071   6e0643  1   0.665268</span>
<span class="co">#&gt; 81e071   efee6b  1   0.665268</span>
<span class="co">#&gt; 81e071   252679  1   0.665268</span>
<span class="co">#&gt; dc72e8   f59e4b  1   0.714597</span>
<span class="co">#&gt; 4e2918   ef7028  1   0.6355</span>
<span class="co">#&gt; 2fabc7   dc72e8  1   0.682885</span>
<span class="co">#&gt; ad208a   8e02f0  1   0.595</span>
<span class="co">#&gt; 48f980   d4d75e  1   0.595</span>
<span class="co">#&gt; 24dba7   1f4d22  1   0.682885</span>
<span class="co">#&gt; 327734   486c07  1   0.67195</span>
<span class="co">#&gt; 4e8dc8   6ddfa3  1   0.67195</span>
<span class="co">#&gt; 206e37   24dba7  1   0.64765</span>
<span class="co">#&gt; 958de8   f60e85  1   0.621325</span>
<span class="co">#&gt; 2d3187   337cac  1   0.595</span>
<span class="co">#&gt; 7d21f1   030327  1   0.6085</span>
<span class="co">#&gt; 7d21f1   735807  1   0.6085</span>
<span class="co">#&gt; 7d21f1   81e071  1   0.6085</span></code></pre></div>
<p>Now we are ready to draw lots of isolates.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sg_sinks &lt;-<span class="st"> </span><span class="kw"><a href="../reference/sinks.html">sinks</a></span>(sent_graph2)
<span class="kw"><a href="../reference/draw_isolates.html">draw_isolates</a></span>(sg_net_dir, <span class="kw">data.frame</span>(sg_sinks, <span class="kw">rep</span>(<span class="dv">20</span>, <span class="kw">length</span>(sg_sinks))))
<span class="co">#&gt;      node allele_0 allele_1 allele_2</span>
<span class="co">#&gt; 1  acf7bb        0        0       20</span>
<span class="co">#&gt; 2  9f5aad        0        0       20</span>
<span class="co">#&gt; 3  0b57e4        0        0       20</span>
<span class="co">#&gt; 4  78e5ba        0        0       20</span>
<span class="co">#&gt; 5  ca432a        0        0       20</span>
<span class="co">#&gt; 6  e45c54        0        0       20</span>
<span class="co">#&gt; 7  80afad       19        1        0</span>
<span class="co">#&gt; 8  cede47        0       20        0</span>
<span class="co">#&gt; 9  82b4fc        0       20        0</span>
<span class="co">#&gt; 10 732379        0       18        2</span>
<span class="co">#&gt; 11 9199be        2       18        0</span>
<span class="co">#&gt; 12 7d3df0        0       16        4</span>
<span class="co">#&gt; 13 c77a84       20        0        0</span>
<span class="co">#&gt; 14 6f5824       20        0        0</span>
<span class="co">#&gt; 15 3b712b        0        0       20</span>
<span class="co">#&gt; 16 1e7431        0        0       20</span>
<span class="co">#&gt; 17 37aad9        0        0       20</span>
<span class="co">#&gt; 18 44060b       20        0        0</span>
<span class="co">#&gt; 19 905296       16        0        4</span>
<span class="co">#&gt; 20 f951d8       17        0        3</span>
<span class="co">#&gt; 21 b4e5d5        2        0       18</span>
<span class="co">#&gt; 22 1b55d2        0        0       20</span>
<span class="co">#&gt; 23 a6fcaf        0        0       20</span>
<span class="co">#&gt; 24 24876f        0        9       11</span>
<span class="co">#&gt; 25 0fffca       20        0        0</span>
<span class="co">#&gt; 26 09f4a0        0        3       17</span>
<span class="co">#&gt; 27 38881f       20        0        0</span>
<span class="co">#&gt; 28 d81c17       19        0        1</span>
<span class="co">#&gt; 29 1569a5       17        0        3</span>
<span class="co">#&gt; 30 064974       20        0        0</span>
<span class="co">#&gt; 31 161814       20        0        0</span>
<span class="co">#&gt; 32 c09e12       20        0        0</span>
<span class="co">#&gt; 33 b08945        0        4       16</span>
<span class="co">#&gt; 34 f80b2e        0        0       20</span>
<span class="co">#&gt; 35 35a9b6       20        0        0</span>
<span class="co">#&gt; 36 6e0643       16        0        4</span>
<span class="co">#&gt; 37 efee6b       17        0        3</span>
<span class="co">#&gt; 38 252679        4       10        6</span>
<span class="co">#&gt; 39 f59e4b        0        7       13</span>
<span class="co">#&gt; 40 ef7028        8        1       11</span>
<span class="co">#&gt; 41 1f4d22        0       20        0</span>
<span class="co">#&gt; 42 486c07        0        0       20</span></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#installing-the-package">Installing the package</a></li>
      <li><a href="#what-does-it-do">What does it do?</a></li>
      <li>
<a href="#a-quick-overview">A quick overview</a><ul class="nav nav-pills nav-stacked">
<li><a href="#preparing-the-network">Preparing the network</a></li>
      <li><a href="#injecting-initial-populations-and-simulating-spread">Injecting initial populations and simulating spread</a></li>
      <li><a href="#drawing-samples">Drawing samples</a></li>
      </ul>
</li>
      <li><a href="#an-example-using-real-data">An example using real data</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Martin Hinsch.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>

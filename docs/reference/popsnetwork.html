<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>popsnetwork — popsnetwork • rpathsonpaths</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>
  
  
<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">rpathsonpaths</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/overview.html">Overview of the rpathsonpaths package</a>
    </li>
  </ul>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/mhinsch/rpathsonpaths">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>popsnetwork</h1>
    </div>

    
    <p>Create a popsnetwork object.</p>
    

    <pre class="usage"><span class='fu'>popsnetwork</span>(<span class='no'>links</span>, <span class='no'>external</span>, <span class='kw'>transmission</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='kw'>decay</span> <span class='kw'>=</span> -<span class='fl'>1</span>,
  <span class='kw'>spread_model</span> <span class='kw'>=</span> <span class='st'>"fluid"</span>, <span class='kw'>checks</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>links</th>
      <td><p>A dataframe describing all edges in the graph as well as transfer rates
between them. The first two columns are read as inputs and outputs. If there are only 
two columns all rates are assumed to be 1.</p></td>
    </tr>
    <tr>
      <th>external</th>
      <td><p>A dataframe describing external inputs into the network. The first column
is expected to contain node ids (as indices or factors), the second column specifies 
the amount of infected material in the input. If there is a third column present it can
be used to set overall input rates on the respective nodes (this is relevant for the ibm).</p></td>
    </tr>
    <tr>
      <th>transmission</th>
      <td><p>Rate of infection within nodes (i.e. proportion of uninfected material
becoming infected).</p></td>
    </tr>
    <tr>
      <th>decay</th>
      <td><p>The decay of material within nodes.
If this parameter has a value in [0, 1) transport rates for the entire network will 
be rescaled so that sum(output) == sum(input) * (1-decay) in all (non-leaf) nodes.</p></td>
    </tr>
    <tr>
      <th>spread_model</th>
      <td><p>How to model spread of pathogens. With "fluid" the substrate carrying
the infection and the pathogen itself is essentially treated as a fluid and rates are 
calculated deterministically. With "units" infection as well as selection of infected vs.
uninfected material at outputs is modelled as a stochastic process on discrete units.</p></td>
    </tr>
    <tr>
      <th>checks</th>
      <td><p>Perform some basic integrity checks on input data (currently looks for cycles
and disconnected sub-networks).</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A popsnetwork object.</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>A popsnetwork object stores the nodes and edges making up a food transport
network and associated data describing spread of infected material on the
network. A network is created from a tabular description of its edges.</p>
    
    <h2 class="hasAnchor" id="edge-lists-and-node-ids"><a class="anchor" href="#edge-lists-and-node-ids"></a>Edge lists and node ids</h2>

    
    <p>Many functions in rpathsonpaths take edge lists as an argument. An edge list is a 
data frame with at least two columns. These columns can be either integer vectors
which will be interpreted as <em>0-based node indices</em> or factors. In general where
applicable functions will return the same format they received.</p>
<p>Note that formats 
can not be mixed easily. Function arguments (and data frame columns) have to have the 
same type. Furthermore nodes in a <code>popsnetwork</code> object generated with integer
indices can not be referenced by name.</p>
<p>In general integer indices are considerably faster than factors.</p>
    
    <h2 class="hasAnchor" id="using-popsnetwork"><a class="anchor" href="#using-popsnetwork"></a>Using popsnetwork</h2>

    
    <p>Generating simulated genetic data from a popsnetwork object happens in several steps:</p><ol>
<li><p>Create the basic network using the constructor <code>popsnetwork</code>.</p></li>
<li><p>Set initial allele frequencies for a number of nodes using 
<code><a href='set_allele_freqs.html'>set_allele_freqs</a></code>. Note that the initial allele distribution can also
be set in the next step, allowing this step to be skipped.</p></li>
<li><p>Simulate spread of genetic material through the network with 
<code><a href='popgen_dirichlet.html'>popgen_dirichlet</a></code>.</p></li>
<li><p>Draw samples from the simulated population using 
<code><a href='draw_isolates.html'>draw_isolates</a></code>.</p></li>
</ol>
    <p>A worked example is available in the 'overview' vignette.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># 1) fluid model</span>
<span class='co'># this model is pretty resilient to numerical issues</span>
<span class='no'>inp</span> <span class='kw'>&lt;-</span> <span class='fu'>c</span>(<span class='fl'>0L</span>, <span class='fl'>0L</span>, <span class='fl'>1L</span>, <span class='fl'>2L</span>, <span class='fl'>3L</span>, <span class='fl'>1L</span>, <span class='fl'>5L</span>)
<span class='no'>outp</span> <span class='kw'>&lt;-</span> <span class='fu'>c</span>(<span class='fl'>1L</span>, <span class='fl'>2L</span>, <span class='fl'>3L</span>, <span class='fl'>3L</span>, <span class='fl'>4L</span>, <span class='fl'>4L</span>, <span class='fl'>2L</span>)
<span class='no'>rates</span> <span class='kw'>&lt;-</span> <span class='fu'>c</span>(<span class='fl'>1</span>, <span class='fl'>1.5</span>, <span class='fl'>0.5</span>, <span class='fl'>0.1</span>, <span class='fl'>1</span>, <span class='fl'>0.1</span>, <span class='fl'>0.5</span>)
<span class='no'>edgelist</span> <span class='kw'>&lt;-</span> <span class='fu'>data.frame</span>(<span class='no'>inp</span>, <span class='no'>outp</span>, <span class='no'>rates</span>)
<span class='no'>ext</span> <span class='kw'>&lt;-</span> <span class='fu'>data.frame</span>(<span class='fu'>c</span>(<span class='fl'>0L</span>, <span class='fl'>5L</span>), <span class='fu'>c</span>(<span class='fl'>0.5</span>, <span class='fl'>0.5</span>))
<span class='no'>net</span> <span class='kw'>&lt;-</span> <span class='fu'>popsnetwork</span>(<span class='no'>edgelist</span>, <span class='no'>ext</span>, <span class='fl'>0.1</span>)

<span class='co'># 2) units model</span>
<span class='co'># for this model absolute numbers are relevant</span>
<span class='co'># note that whether we use integer or string node ids is completely arbitrary </span></div><span class='co'># NOT RUN {</span>
<span class='co'># this will produce an error in popsnetwork since node C's output is larger than</span>
<span class='co'># its input (300 &gt; 250)</span>
<span class='no'>el</span> <span class='kw'>&lt;-</span> <span class='fu'>data.frame</span>(<span class='kw'>from</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='st'>"A"</span>, <span class='st'>"B"</span>, <span class='st'>"C"</span>), <span class='kw'>to</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='st'>"C"</span>, <span class='st'>"C"</span>, <span class='st'>"D"</span>), <span class='kw'>rates</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>150</span>, <span class='fl'>100</span>, <span class='fl'>300</span>))
<span class='no'>ext</span> <span class='kw'>&lt;-</span> <span class='fu'>data.frame</span>(<span class='kw'>node</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='st'>"A"</span>, <span class='st'>"B"</span>), <span class='kw'>rate</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>300</span>, <span class='fl'>100</span>), <span class='kw'>input</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>1000</span>, <span class='fl'>1000</span>))
<span class='no'>net</span> <span class='kw'>&lt;-</span> <span class='fu'>popsnetwork</span>(<span class='no'>el</span>, <span class='no'>ext</span>, <span class='kw'>spread_model</span><span class='kw'>=</span><span class='st'>"units"</span>)
<span class='co'># }</span><div class='input'>
<span class='co'># if we reduce C's output a bit it works fine</span>
<span class='no'>el</span> <span class='kw'>&lt;-</span> <span class='fu'>data.frame</span>(<span class='kw'>from</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='st'>"A"</span>, <span class='st'>"B"</span>, <span class='st'>"C"</span>), <span class='kw'>to</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='st'>"C"</span>, <span class='st'>"C"</span>, <span class='st'>"D"</span>), <span class='kw'>rates</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>150</span>, <span class='fl'>100</span>, <span class='fl'>200</span>))
<span class='no'>ext</span> <span class='kw'>&lt;-</span> <span class='fu'>data.frame</span>(<span class='kw'>node</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='st'>"A"</span>, <span class='st'>"B"</span>), <span class='kw'>rate</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>300</span>, <span class='fl'>100</span>), <span class='kw'>input</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>1000</span>, <span class='fl'>1000</span>))
<span class='no'>net</span> <span class='kw'>&lt;-</span> <span class='fu'>popsnetwork</span>(<span class='no'>el</span>, <span class='no'>ext</span>, <span class='kw'>spread_model</span><span class='kw'>=</span><span class='st'>"units"</span>)</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#edge-lists-and-node-ids">Edge lists and node ids</a></li>

      <li><a href="#using-popsnetwork">Using popsnetwork</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Martin Hinsch.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>

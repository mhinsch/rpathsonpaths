<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>popgen_ibm_mixed — popgen_ibm_mixed • rpathsonpaths</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>
  
  
<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">rpathsonpaths</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/hacking.html">Extending rpathsonpaths</a>
    </li>
    <li>
      <a href="../articles/overview.html">Overview of the rpathsonpaths package</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/mhinsch/rpathsonpaths">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>popgen_ibm_mixed</h1>
    </div>

    
    <p>Simulate spread of pathogens on the network using a (very) simple individual-based
model.</p>
    

    <pre class="usage"><span class='fu'>popgen_ibm_mixed</span>(<span class='no'>p_net</span>, <span class='kw'>ini_dist</span> <span class='kw'>=</span> <span class='kw'>NULL</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>p_net</th>
      <td><p>A popsnetwork object.</p></td>
    </tr>
    <tr>
      <th>ini_dist</th>
      <td><p>Initial distribution of allele frequencies (optional). ini_dist has to be 
a list
containing a vector of node IDs (see <code><a href='popsnetwork.html'>popsnetwork</a></code>) and
a matrix of allele frequencies. Note that *any* node pre-set in this
way will effectively be treated as a source and hide nodes that are further upstream (see
<code><a href='set_allele_freqs.html'>set_allele_freqs</a></code>).</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A new popsnetwork object with allele frequencies set for each node.</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This function simulates the change of gene frequencies in a population
of pathogens as they spread through the transport network starting at the 
external sources (see <code><a href='popsnetwork.html'>popsnetwork</a></code>). At each node founder
effects are assumed to change composition of the population. This change is 
simulated by directly drawing from the distribution of genotypes and unfected units,
respectively. Note that for numerical reasons this model will not work for small
absolute numbers of units (input and transfer rates). It is also strongly recommended
to only run this model on networks that have been generated with the "units" method
(see <code><a href='popsnetwork.html'>popsnetwork</a></code>).</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># create network</span>
<span class='no'>el</span> <span class='kw'>&lt;-</span> <span class='fu'>data.frame</span>(<span class='kw'>from</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='st'>"A"</span>, <span class='st'>"B"</span>, <span class='st'>"C"</span>), <span class='kw'>to</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='st'>"C"</span>, <span class='st'>"C"</span>, <span class='st'>"D"</span>), <span class='kw'>rates</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>150</span>, <span class='fl'>100</span>, <span class='fl'>200</span>))
<span class='no'>ext</span> <span class='kw'>&lt;-</span> <span class='fu'>data.frame</span>(<span class='kw'>node</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='st'>"A"</span>, <span class='st'>"B"</span>), <span class='kw'>rate</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>300</span>, <span class='fl'>100</span>), <span class='kw'>input</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>1000</span>, <span class='fl'>1000</span>))
<span class='no'>net</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='popsnetwork.html'>popsnetwork</a></span>(<span class='no'>el</span>, <span class='no'>ext</span>, <span class='kw'>spread_model</span><span class='kw'>=</span><span class='st'>"units"</span>)

<span class='co'># set allele frequencies (2 nodes, 3 alleles)</span>
<span class='no'>freqs</span> <span class='kw'>&lt;-</span> <span class='fu'>matrix</span>(<span class='fu'>c</span>(<span class='fl'>0.1</span>, <span class='fl'>0.5</span>, <span class='fl'>0.4</span>, <span class='fl'>0.9</span>, <span class='fl'>0.1</span>, <span class='fl'>0</span>), <span class='kw'>nrow</span><span class='kw'>=</span><span class='fl'>2</span>, <span class='kw'>ncol</span><span class='kw'>=</span><span class='fl'>3</span>, <span class='kw'>byrow</span><span class='kw'>=</span><span class='fl'>TRUE</span>)
<span class='no'>ini_freqs</span> <span class='kw'>&lt;-</span> <span class='fu'>list</span>(<span class='fu'>as.factor</span>(<span class='fu'>c</span>(<span class='st'>"A"</span>, <span class='st'>"C"</span>)), <span class='no'>freqs</span>)

<span class='co'># run simulation on initialized net</span>
<span class='no'>ini_net</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='set_allele_freqs.html'>set_allele_freqs</a></span>(<span class='no'>net</span>, <span class='no'>ini_freqs</span>)
<span class='fu'>popgen_ibm_mixed</span>(<span class='no'>ini_net</span>)</div><div class='output co'>#&gt; Nodes:
#&gt; 
#&gt; id	infected	input	alleles...
#&gt; A	0.3	1000	0.0966667	0.506667	0.396667
#&gt; B	0.1	1000	1	0	0
#&gt; C	0.228	250	0.912281	0.0877193	0
#&gt; D	0.25	200	0.94	0.06	0
#&gt; 
#&gt; Links:
#&gt; 
#&gt; from	to	rate	infected
#&gt; A	C	150	0.28
#&gt; B	C	100	0.15
#&gt; C	D	200	0.25</div><div class='input'>
<span class='co'># or we can initialize and run in one call</span>
<span class='fu'>popgen_ibm_mixed</span>(<span class='no'>net</span>, <span class='no'>ini_freqs</span>)</div><div class='output co'>#&gt; Nodes:
#&gt; 
#&gt; id	infected	input	alleles...
#&gt; A	0.3	1000	0.133333	0.493333	0.373333
#&gt; B	0.1	1000	1	0	0
#&gt; C	0.228	250	0.929825	0.0701754	0
#&gt; D	0.25	200	0.92	0.08	0
#&gt; 
#&gt; Links:
#&gt; 
#&gt; from	to	rate	infected
#&gt; A	C	150	0.28
#&gt; B	C	100	0.15
#&gt; C	D	200	0.25</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Martin Hinsch.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>

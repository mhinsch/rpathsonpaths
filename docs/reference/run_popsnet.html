<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>run_popsnet — run_popsnet • rpathsonpaths</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>
  
  
<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">rpathsonpaths</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/hacking.html">Extending rpathsonpaths</a>
    </li>
    <li>
      <a href="../articles/overview.html">Overview of the rpathsonpaths package</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/mhinsch/rpathsonpaths">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>run_popsnet</h1>
    </div>

    
    <p>Create a popsnetwork and run the transport simulation.</p>
    

    <pre class="usage"><span class='fu'>run_popsnet</span>(<span class='no'>edgelist</span>, <span class='no'>ini_input</span>, <span class='no'>ini_infd</span>, <span class='no'>ini_freqs</span>, <span class='kw'>n</span> <span class='kw'>=</span> <span class='fl'>1L</span>,
  <span class='kw'>transmission</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='kw'>decay</span> <span class='kw'>=</span> -<span class='fl'>1</span>, <span class='kw'>theta</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>spread_model</span> <span class='kw'>=</span> <span class='st'>"units"</span>,
  <span class='kw'>drift_model</span> <span class='kw'>=</span> <span class='st'>"units"</span>, <span class='kw'>checks</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>edgelist</th>
      <td><p>The list of edges as a dataframe, with origin in the first and target in 
the second column. If a third column is present it is interpreted as transfer rates per
edge.</p></td>
    </tr>
    <tr>
      <th>ini_input</th>
      <td><p>Net input rates per source node. Note that source nodes in the network
will be automatically detected and will be processed in order of node id. ini_input can 
either be a single number that will be a repeated for each source node or a list containing
one element per source node.</p></td>
    </tr>
    <tr>
      <th>ini_infd</th>
      <td><p>Input rate of infected units per source nodes. Format requirements are
identical to those for <code>ini_input</code>.</p></td>
    </tr>
    <tr>
      <th>ini_freqs</th>
      <td><p>Allele frequencies per source node. This can be one out of:</p><ul>
<li><p>a matrix with one row per root node</p></li>
<li><p>a list of initialization objects (each of them containing a vector of node ids 
and a matrix of frequencies, see <code><a href='set_allele_freqs.html'>set_allele_freqs</a></code>). In this case 
n simulations are run per initialization.</p></li>
</ul></td>
    </tr>
    <tr>
      <th>n</th>
      <td><p>Number of simulation runs to perform.</p></td>
    </tr>
    <tr>
      <th>transmission</th>
      <td><p>Rate of infection in nodes.</p></td>
    </tr>
    <tr>
      <th>decay</th>
      <td><p>Decay rate in nodes - used to infer transfer rates. If this is negative all 
transfer rates will be assumed to be 1 (which in most cases is not a very useful value)
unless edgelist has a third column (see above). If decay is not negative transfer rates
will be inferred assuming preservation of mass with decay at the nodes. Note that the ibm
simulation requires output to be smaller or equal than input for all nodes.</p></td>
    </tr>
    <tr>
      <th>theta</th>
      <td><p>The shape parameter for the Dirichlet distribution.</p></td>
    </tr>
    <tr>
      <th>spread_model</th>
      <td><p>Either "fluid" or "units".</p></td>
    </tr>
    <tr>
      <th>drift_model</th>
      <td><p>Either "dirichlet" or "units".</p></td>
    </tr>
    <tr>
      <th>checks</th>
      <td><p>Whether to perform some sanity checks on the graph before simulating (slow).</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list containing the network object(s) produced by the simulation(s) as first and 
the raw network as the second element.</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This function creates a popsnetwork object from the given parameters and runs 
either the ibm or dirichlet simulation on it.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># the network</span>
<span class='no'>edgelist</span> <span class='kw'>&lt;-</span> <span class='fu'>data.frame</span>(<span class='kw'>from</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='st'>"A"</span>, <span class='st'>"B"</span>, <span class='st'>"C"</span>), <span class='kw'>to</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='st'>"C"</span>, <span class='st'>"C"</span>, <span class='st'>"D"</span>))
<span class='co'># allele frequencies, 3 alleles x 2 source nodes (A, B)</span>
<span class='no'>freqs</span> <span class='kw'>&lt;-</span> <span class='fu'>matrix</span>(<span class='fu'>c</span>(<span class='fl'>0.1</span>, <span class='fl'>0.5</span>, <span class='fl'>0.4</span>, <span class='fl'>0.9</span>, <span class='fl'>0.1</span>, <span class='fl'>0</span>), <span class='kw'>nrow</span><span class='kw'>=</span><span class='fl'>2</span>, <span class='kw'>ncol</span><span class='kw'>=</span><span class='fl'>3</span>, <span class='kw'>byrow</span><span class='kw'>=</span><span class='fl'>TRUE</span>)
<span class='co'># run </span>
<span class='fu'>run_popsnet</span>(<span class='no'>edgelist</span>, <span class='fl'>10</span>, <span class='fl'>0.1</span>, <span class='no'>freqs</span>)</div><div class='output co'>#&gt; $result
#&gt; $result[[1]]
#&gt; Nodes:
#&gt; 
#&gt; id	infected	input	alleles...
#&gt; A	0	10	0	0	0
#&gt; B	0	10	0	0	0
#&gt; C	0	2	0	0	0
#&gt; D	0	1	0	0	0
#&gt; 
#&gt; Links:
#&gt; 
#&gt; from	to	rate	infected
#&gt; A	C	1	0
#&gt; B	C	1	0
#&gt; C	D	1	0
#&gt; 
#&gt; 
#&gt; $raw
#&gt; Nodes:
#&gt; 
#&gt; id	infected	input	alleles...
#&gt; A	0	10
#&gt; B	0	10
#&gt; C	0	2
#&gt; D	0	1
#&gt; 
#&gt; Links:
#&gt; 
#&gt; from	to	rate	infected
#&gt; A	C	1	0
#&gt; B	C	1	0
#&gt; C	D	1	0
#&gt; 
#&gt; $meta
#&gt; $meta$spread
#&gt; [1] "units"
#&gt; 
#&gt; $meta$drift
#&gt; [1] "units"
#&gt; 
#&gt; $meta$n_inp
#&gt; [1] 1
#&gt; 
#&gt; $meta$n_sources
#&gt; [1] 2
#&gt; 
#&gt; $meta$n_ini
#&gt; [1] 1
#&gt; 
#&gt; </div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Martin Hinsch.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
